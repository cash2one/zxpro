<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>捷易拍OCX控件测试程序JavaScript</title>

    <script language="JavaScript1.2">
        function Start1_onclick() {
            var str = captrue.bStopPlay();
            var str = captrue.bStartPlay();
        }
        function Start2_onclick() {
            var str = captrue.bStopPlay();
            var str = captrue.bStartPlay2(0);
        }
        function Stop_onclick() {
            var str = captrue.bStopPlay();
        }

        function SaveJPG_onclick() {
            var picname = (new Date()).getTime();
            var picpath = "C:\\imagestmpdir\\";
            console.log(picpath + picname)
            var str = captrue.bSaveJPG(picpath, picname);
            setFileValue('id_patientpics_set-0-pic', picpath + picname + ".jpg");
            console.log(picname + " saved")
            console.log(str);
        }

        function UpLoadJPG_onclick() {
            var str = captrue.bUpLoadImage("C:\\1417964926911.jpg", "127.0.0.1", 8000, "picss/");
        }

        function DeleteJPG_onclick() {

            var str = captrue.bDeleteFile("C:\\imagetmp\\" + (new Date()).getTime() + ".jpg");
        }

        function SaveGray_onclick() {
            //captrue.vSetRotate(90);
            var str = captrue.bSaveGray("C:\\", "gray");
        }
        function SaveTifJPG_onclick() {
            captrue.vSetRotate(180);
            var str = captrue.bSaveTifJPG("C:\\", "tifJPG");
        }
        function SaveTIF_onclick() {
            captrue.vSetRotate(270);
            captrue.vSetDPI(200, 200);
            captrue.vSetTIFPara(0.3, 0.59, 0.11, 0.2);
            var str = captrue.bSaveTIF24Bit("C:\\", "TIF", 0);
        }

        function SaveMulTIF_onclick() {
            captrue.vSetDPI(200, 200);
            var str = captrue.bSaveTIF24Bit("C:\\", "MulTIF", 1);
        }
        function ParaSet_onclick() {
            var str = captrue.displayVideoPara();
        }
        function ParaSetPIN_onclick() {
            var str = captrue.vSetCapturePin();
            captrue.bStartPlay();
        }
        function CutHB_onclick() {
            var str = captrue.vSetDelHBFlag(1);
        }
        function Skew_onclick() {
            var str = captrue.vSetSkewFlag(1);
        }
        function StartPDF_onclick() {
            var pdffileName = document.getElementById("pdffileName").value;
            if (pdffileName == "") {
                pdffileName = "pdffile";
            }
            var str = captrue.bSavePDFStart("C:\\", pdffileName);
        }
        function ColorPDF_onclick() {
            var str = captrue.bSavePDFColorPage();
        }
        function BWPDF_onclick() {
            var str = captrue.bSavePDFBWPage();
        }

        function EndPDF_onclick() {
            var str = captrue.bSavePDFEnd();
        }

        function SetBrightness_onclick() {
            var BrightnessValue = document.getElementById("BrightnessValue").value;
            captrue.vSetBrightness(BrightnessValue);
        }

        function SetContrast_onclick() {
            var ContrastValue = document.getElementById("ContrastValue").value;
            captrue.vSetContrast(ContrastValue);
        }

        function rotateMain() {
            var str = captrue.bStopPlay();
            var str = captrue.bStartPlayRotate(270);

        }

        function getDeviceId() {
            var deviceId = captrue.sGetDevicesId();
            alert(deviceId);
        }

        function selectAutoMode(el) {
            captrue.bSetMode(el.value);
        }

        function selectDefaultMode(el) {
            captrue.bSetMode(el.value);
        }

        function selectSfzMode(el) {
            captrue.bSetMode(el.value);
            if (el.value == 1) {
                captrue.bSetImageArea(1000, 1000, 8000, 8000);
            }
        }

        function SelectExposure(el) {
            captrue.vSetExposure(el.value);
        }
        function setFileValue(objfile, vvalues) {
            window.clipboardData.setData('text', vvalues);
            var WshShell = new ActiveXObject("WScript.Shell");
            document.getElementById(objfile).focus();
            WshShell.sendKeys("c ");//不支持中文
            WshShell.sendKeys("^a");
            WshShell.sendKeys("^v");//模拟键盘ctrl + v 的粘贴操作。
            WshShell.sendKeys("%o");//模拟键盘ctrl + v 的粘贴操作。
        }
    </script>

</head>

<body>

<div style="text-align:center;">
    <object classid="clsid:454C18E2-8B7D-43C6-8C17-B1825B49D7DE" id="captrue" width="480" height="360"></object>
</div>

</p>
<form method="POST" action="--WEBBOT-SELF--" name="form1">
    <input type="button" value="启动主" name="StartBtn" onclick="Start1_onclick()">
    <script type="text/javascript">Start1_onclick();</script>
    <input type="button" value="ceshi" name="test" onclick="setFileValue('picfile','C:\\JPG.jpg')">
    <input type="button" value="启动副" name="StopBtn" onclick="Start2_onclick()">
    <input type="button" value="停止" name="StopBtn" onclick="Stop_onclick()">
    <input type="button" value="JPG" name="SaveJPGBtn" onclick="SaveJPG_onclick()">
    <input type="button" value="Gray" name="SaveJPGBtn" onclick="SaveGray_onclick()">
    <input type="button" value="TIF" name="SaveTIFBtn" onclick="SaveMulTIF_onclick()">
    <input type="button" value="TIFJPG" name="SaveTIFBtn" onclick="SaveTifJPG_onclick()">
    <input type="button" value="设置切黑边" name="SaveTIFBtn" onclick="CutHB_onclick()">
    <input type="button" value="设置矫正" name="SaveTIFBtn" onclick="Skew_onclick()">
    <input type="button" value="参数设置" name="ParaSet" onclick="ParaSet_onclick()">
    <input type="button" value="PIN设置" name="ParaSet" onclick="ParaSetPIN_onclick()"></p>
    <input type="button" value="删除JPG" name="DeleteJPGBtn" onclick="DeleteJPG_onclick()">
    <input type="button" value="上传JPG" name="UpLoadBtn" onclick="UpLoadJPG_onclick()">
    PDF文件名：<input type="text" id="pdffileName"/>
    <input type="button" value="开始拍PDF" name="StartPDFBtn" onclick="StartPDF_onclick()">
    <input type="button" value="增加PDF彩页" name="ColorPDFBtn" onclick="ColorPDF_onclick()">
    <input type="button" value="增加图像" name="ColorPDFBtn" onclick="ImgPDF_onclick()">
    <input type="button" value="增加PDF黑白页" name="BWPDFBtn" onclick="BWPDF_onclick()">
    <input type="button" value="结束拍PDF" name="EndPDFBtn" onclick="EndPDF_onclick()">
    </p>
    亮度:<input type="text" value="20" style="width:30px;" id="BrightnessValue"/>
    <input type="button" value="设置" onclick="SetBrightness_onclick()">
    对比度:<input type="text" value="20" style="width:30px;" id="ContrastValue"/>
    <input type="button" value="设置" onclick="SetContrast_onclick()">
    曝光度:
    <select id="ExposureValue" onchange="SelectExposure(this)">
        <option value="0">0</option>
        <option value="10">10</option>
        <option value="20">20</option>
        <option value="30">30</option>
        <option value="40">40</option>
        <option value="50" selected="selected">50</option>
        <option value="60">60</option>
        <option value="70">70</option>
        <option value="80">80</option>
        <option value="90">90</option>
        <option value="100">100</option>
    </select>

    <input type="button" value="主旋" onclick="rotateMain()">

    <input type="button" value="硬件ID" onclick="getDeviceId()">

    <input type="radio" value="3" name="mode" id="autoMode" onclick="selectAutoMode(this)"/><label
        for="autoMode">自动</label>
    <input type="radio" value="0" name="mode" id="defaultMode" onclick="selectDefaultMode(this)"/><label for="autoMode">默认</label>
    <input type="radio" value="4" name="mode" id="sfzMode" onclick="selectSfzMode(this)"/><label
        for="autoMode">证件</label>
    <input type="radio" value="1" name="mode" id="customMode" onclick="selectSfzMode(this)"/><label
        for="autoMode">自定义</label>

    <p>
        <br/>


</form>
<form action="{% url "upload" %}" enctype="multipart/form-data" method="post">{% csrf_token %}
    <input type="file" name="picfile" id="picfile">
    <button value="提交" type="submit">提交</button>
</form>
</body>
</html>
